subject_list={'1','3'};
numsubjects = length(subject_list);

for s=1:numsubjects;
subject = subject_list{s};
datafolder = '/Users/agnesgao/Dropbox/UCD/data/data-selected';

%loads dataset
EEG = pop_loadset(['pilot_s' subject '_1a.set'],datafolder);

EEG=pop_chanedit(EEG, 'lookup','standard-10-5-cap385.elp');


EEG = pop_eegchanoperator( EEG, {  'nch1 = ch1 - ( 0.5*ch30 ) Label FP1',  'nch2 = ch2 - ( 0.5*ch30 ) Label FP2',  'nch3 = ch3 - ( 0.5*ch30 ) Label F3',...
  'nch4 = ch4 - ( 0.5*ch30 ) Label F4',  'nch5 = ch5 - ( 0.5*ch30 ) Label F7',  'nch6 = ch6 - ( 0.5*ch30 ) Label F8',...
  'nch7 = ch7 - ( 0.5*ch30 ) Label FC1',  'nch8 = ch8 - ( 0.5*ch30 ) Label FC2',  'nch9 = ch9 - ( 0.5*ch30 ) Label FC5',  'nch10 = ch10 - ( 0.5*ch30 ) Label FC6',...
  'nch11 = ch11 - ( 0.5*ch30 ) Label C3',  'nch12 = ch12 - ( 0.5*ch30 ) Label C4',  'nch13 = ch13 - ( 0.5*ch30 ) Label T3',...
  'nch14 = ch14 - ( 0.5*ch30 ) Label T4',  'nch15 = ch15 - ( 0.5*ch30 ) Label CP1',  'nch16 = ch16 - ( 0.5*ch30 ) Label CP2',...
  'nch17 = ch17 - ( 0.5*ch30 ) Label CP5',  'nch18 = ch18 - ( 0.5*ch30 ) Label CP6',  'nch19 = ch19 - ( 0.5*ch30 ) Label P3',  'nch20 = ch20 - ( 0.5*ch30 ) Label P4',...
  'nch21 = ch21 - ( 0.5*ch30 ) Label T5',  'nch22 = ch22 - ( 0.5*ch30 ) Label T6',  'nch23 = ch23 - ( 0.5*ch30 ) Label O1',...
  'nch24 = ch24 - ( 0.5*ch30 ) Label O2',  'nch25 = ch25 - ( 0.5*ch30 ) Label AFZ',  'nch26 = ch26 - ( 0.5*ch30 ) Label FZ',  'nch27 = ch27 - ( 0.5*ch30 ) Label CZ',...
  'nch28 = ch28 - ( 0.5*ch30 ) Label PZ',  'nch29 = ch29 - ( 0.5*ch30 ) Label POZ',  'nch30 = ch30 Label LM',  'nch31 = ch31 Label HEOGR',...
  'nch32 = ch32 Label VEOGU'} , 'ErrorMsg', 'popup',...
 'Warning', 'off' );


EEG  = pop_creabasiceventlist( EEG , 'AlphanumericCleaning', 'on', 'BoundaryNumeric', { -99 },...
    'BoundaryString', { 'boundary' }, 'Eventlist',...
 ['/Users/agnesgao/Dropbox/UCD/data/2_eventlist' subject '_event.txt']);

EEG  = pop_binlister( EEG , 'BDF', '/Users/agnesgao/Dropbox/UCD/data/word_pred_bdf_ag.txt', 'ExportEL',...
['/Users/agnesgao/Dropbox/UCD/data/5_new_elist/' subject 'bin_elist.txt'], 'IndexEL',  1, 'Resetflag', 'on', 'SendEL2', 'EEG',...
 'Voutput', 'EEG' );

EEG  = pop_basicfilter( EEG,  1:32 , 'Boundary', 'boundary', 'Cutoff', [ 0.05 30], 'Design', 'butter', 'Filter', 'bandpass', 'Order', 2 );

EEG = pop_epochbin( EEG , [-200.0  1001.0],  'pre'); 


EEG = pop_saveset( EEG, 'filename',[ 's' subject 'epoch.set'],'filepath', '/Users/agnesgao/Dropbox/UCD/data/6_bin_epoch/');

end